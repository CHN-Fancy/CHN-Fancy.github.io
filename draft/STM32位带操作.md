---
title: STM32位带操作笔记
date: 
categories:
- STM32
tags:
- STM32
- GPIO
- 位带操作
index_img: https://s1.ax1x.com/2020/06/17/NVVNTA.th.jpg
banner_img:  https://s1.ax1x.com/2020/06/17/NVeTo9.jpg
banner_img_hight: 70 
---

# 寄存器位带操作

## 什么是位带操作？位操作？

### 位带操作：

​		通过位带区和位带别名区的地址映射关系可以直接访问寄存器的某一位，并向这一位写值（0或1）。

### 普通的位操作：（使用“&”，“|”指令来想、实现SRAM区域或者外设存储区进行位操作）

​		由于STM32是按字节寻址的，所以并不能直接对位进行操作。若要想改变某个寄存器的值，须先通过寄存器的地址找到这个寄存器并读取寄存器的值，然后根据想要的功能修改读到的值，最后再将修改后的值写入寄存器中。

## 位带操作的优越性在哪？

​		相比于普通的位操作来说位带操作少了寄存器的读和修改的步骤，大大提升运行效率。

## 什么是位带区什么是位带别名区？

### 位带区：

​		是寄存器真实存在的区域。每个寄存器都为4个字节（32位）。

### 位带别名区：

​		是位带区的对应的膨胀区域，可以想象成是一个位带区的映射。位带别名区的某一个字节的地址就对应相应位带区的某一位的地址，对位带别名区的一个字节进行操作就相当于是对位带区中某一位进行操作。

## 为什么有的区域不支持位操作？

​		是由Crotex-M3、C-M4或者其他系统架构所规定的。只要寄存器是属于位带区的，就支持位带操作。Crotex-M3中规定的支持位带操作的区域如下图所示。

![aPmTBQ.jpg](https://s1.ax1x.com/2020/07/27/aPmTBQ.jpg)

分两块区域其中一块为SRAM中最低的1M，另一块为外设寄存器中最低的1M。

### 位操作支持的区域

另外在STM32F1xx和STM32F4xx上大部分的外设寄存器都支持位带操作，但少数外设寄存器并不支持位带操作。一位网友的经历，先来一个[链接](http://www.51hei.com/bbs/dpj-51883-1.html)，以防文章被删留图存档。

![aPupxf.png](https://s1.ax1x.com/2020/07/27/aPupxf.png)



## 地址与位的关系（位带区与位带别名区的膨胀关系图）

![aPuqS0.png](https://s1.ax1x.com/2020/07/27/aPuqS0.png)